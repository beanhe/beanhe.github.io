---
layout: post
title: Nginx 499报错解决方案 
category: web
tags: [nginx,error]
---
- 终于完成部署程序及页面的编写，结果页面访问频繁出现API无响应的情况，到nginx和python后端日志查看一下发现，nginx收到了对应请求，但python后端完全没有任何相关请求日志出现，并且nginx返回码为499，google一下发现很多小伙伴都遇到过这种情况，也去看了一下nginx源码中对499响应的解释，如下：

```
/*
* HTTP does not define the code for the case when a client closed
* the connection while we are processing its request so we introduce
* own code to log such situation when a client has closed the connection
* before we even try to send the HTTP header to it
*/
#define NGX_HTTP_CLIENT_CLOSED_REQUEST 499
```

- 可以看出499是由于客户端在服务端响应前关闭导致，这跟实际情况也一致，因为已知的几次出现这种情况都是同事在访问途中退出页面然后再次访问，解决方法也很简单，直接在Nginx配置中加入`proxy_ignore_client_abort  on;`然后重新加载配置即可。这个参数是保证在出现上述情况时，Nginx仍然会将请求发送至后端并接受其响应而不是直接返回499

---
layout: post
title: vagrant入门
category: 虚拟化
tags: [__beanhe,vagrant,虚拟化]
---

### Vagrant入门

- 官网：https://www.vagrantup.com/
- Vagrantfile:
  - 作用：主配置文件，虚拟机基础配置均在其中配置，使用ruby语法
  - 示例：
  
  ```
  # -*- mode: ruby -*-
# vi: set ft=ruby :
Vagrant.configure("2") do |config|
  # 开始了
  config.vm.provider "virtualbox"
  config.vm.synced_folder "/Users/kubiops", "/vagrant", disabled: true

  config.vm.define "ubuntu1404" do |ubuntu1404|
    ubuntu1404.vm.box = "ubuntu/trusty64"
  end

  config.vm.define "centos7" do |centos7|
    centos7.vm.box = "centos/7"
  end
end
```
  
  - 以上代码中，从第三行开始为有效配置，"#"开头为注释行，其他主要行说明：
    - `3`: 指定此Vagrant的配置版本为版本 "2"
	- `5`: 指定使用`virtualbox`创建虚拟机
	- `6`: 指定虚拟机创建后将本地的`/Users/kubiops`目录挂载到虚拟机的`/vagrant`目录，但是后面有`disabled`且值为`true`表明不挂载
	- `8-10`: 定义一个名为`ubuntu1404`的虚拟机，其中第`9`行表示基于镜像`ubuntu/trusty64`进行创建，镜像默认从[https://atlas.hashicorp.com/](https://atlas.hashicorp.com/)下载
	- `12-14`: 同上，定义一个基于`centos/7`镜像的名为`centos7`的虚拟机
	
  - 配置完成后，直接在配置文件所在目录运行`vagrant up --provider virtualbox`即可进行虚拟机的创建并启动，创建完成后，使用`vagrant ssh ubuntu1404`进入ubuntu虚拟机，使用`vagrant ssh centos7`进入centos7虚拟机，其他常用命令举例：
  - `vagrant halt centos7`：关闭虚拟机centos7
  - `vagrant global-status`：查看全局状态列表
  - `vagrant global-status prune`：清理缓存，会清除已失效的虚拟机
  - `vagrant destroy centos7`： 删除虚拟机centos7
  - `vagrant up ubuntu1404`：启动虚拟机ubuntu1404
  - `vagrant suspend centos7`：挂起虚拟机centos7
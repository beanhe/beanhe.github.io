---
layout: post
title: Grafana告警配置
category: grafana,监控
tags: [__beanhe,grafana,监控]
---

### Grafana告警(Alerting)配置

- Grafana告警设置分为两部分
 - Notification配置
 - Alert配置
	
- Notification配置：其实就是配置告警途径，Grafana支持多种方式的告警：
 - [Email](http://docs.grafana.org/alerting/notifications/#email)
![grafananotification](/files/201702/27135034359_grafananotification.gif "grafananotification")
 - [Webhook](http://docs.grafana.org/alerting/notifications/#webhook)
 ![grafanawebhooknotification](/files/201702/27135600129_grafanawebhooknotification.gif "grafanawebhooknotification")
 - [Slack](http://docs.grafana.org/alerting/notifications/#slack)
 - [Pagerduty](http://docs.grafana.org/alerting/notifications/#pagerduty)
 
- Alerting配置：即配置告警的条件，阈值等具体内容，配置方式是直接进入要配置告警指标所在的Dashboard页面，直接点击指标图标题，然后选择`Edit` -> `Alert`进入配置，具体参考下图：
![alerting](/files/201702/27142218973_alerting.gif "alerting")

- 可能有人已经发现，Grafana的Alerting配置很生动，既可以输入阈值，也可以通过拖动图表右边的红心进行操作，如下图：
![dragheart](/files/201702/27143437046_dragheart.gif "dragheart")

- 以上配置完毕后一定要对当前的修改进行保存，由于Grafana的几乎所有配置都是针对特定的Dashboard进行的，所以这里说的保存也是指当前的Dashboard,保存按钮在页面的右上角，如图：
![save](/files/201702/27143535385_QQ20170227-142628.png "save")

- 保存好后，图表的标题前会有一个灰色的心形标志![heart](/files/201702/27143628646_QQ20170227-143618.png "heart"),这样就代表设置完成，当对应指标达到配置的阈值就会出发报警，具体报警信息由配置的`Notification`方式决定
 - 以下是默认Email报警(`[Alerting]`)邮件示例，邮件中会告知具体报警指标，并且会将告警时刻的截图一并发送出来，很人性化,并且此时进入对应Dashboard会发现心形标志已经变成了碎掉的红心![readheart](/files/201702/27144115757_redheart.png "readheart"):
 ![alertmail](/files/201702/27144401438_alertingmail.png "alertmail")

 - 如果恢复也会有对应的通知邮件(`[OK]`)，心形标志会对应恢复成绿色未裂开的状态![greenheart](/files/201702/27144129734_greenheart.png "greenheart")
 ![okmail](/files/201702/27144415872_okmail.png "okmail")
---
layout: post
title: python给图片加水印
category: python
tags: [__beanhe,python,pillow,水印]
---

#### python图片加水印

Pillow是python中用于为图片加水印的模块，安装文档和依赖请参考：[官方文档](https://pillow.readthedocs.io/en/4.0.x/installation.html)。具体用法如下：

```
#!/usr/bin/env python
from PIL import Image, ImageDraw, ImageFont
import sys
import os
import shutil

workspace = os.path.realpath(os.path.dirname(__file__))
# 定义字体文件
defaultFont = '%s/andaleMono.ttf' % workspace

imgPath = sys.argv[1] #指定要处理的图片路径
originFilePath = sys.argv[2] #指定原始图片备份路径
shutil.copyfile(imgPath,originFilePath)

image = Image.open(imgPath)
width, height = image.size

draw = ImageDraw.Draw(image)
text = "beanhe@kubiops.com"

font = ImageFont.truetype(defaultFont, 12)
textwidth, textheight = draw.textsize(text, font)

# calculate the x,y coordinates of the text
margin = 10
x = width - textwidth - margin
y = height - textheight - margin

# draw watermark in the bottom right corner
draw.text((x, y), text, font=font)

image.save(imgPath)
```
代码可以实现在给定图片的右下角加水印，并且备份，需要传入两个参数，`sys.argv[1]`用于指定要处理的图片，`sys.argv[2]`用于指定原始图片备份路径，`defaultFont`变量指定了字体文件路径，这里为` '%s/andaleMono.ttf' % workspace`即放在当前目录下名为`andaleMono.ttf`的文件
最终效果如下：
- 原图
![原图](/files/201703/14145105636_WechatIMG2.jpg "原图")
- 处理后
![水印图](/files/201703/14145121293_test.jpg "水印图")